<link rel="preload" as="script" href="/__/firebase/init.js">
<link rel="import" href="../polymerfire/firebase-app-script.html">
<link rel="import" href="../polymerfire/firebase-database-script.html">
<link rel="import" href="../polymerfire/firebase-auth-script.html">
<link rel="import" href="../polymerfire/firebase-storage-script.html">
<link rel="import" href="../polymerfire/firebase-messaging-script.html">
<link rel="import" href="../polymerfire/firebase-firestore-script.html">
<link rel="import" href="../polymerfire/firebase-functions-script.html">
<script>
  /* eslint-disable quotes,max-len */
  "use strict";
  if (typeof firebase === 'undefined') {
    throw new Error('hosting/init-error: Firebase SDK not detected. You must include it before firebase-init.html');
  }
  let script = document.createElement('script');
  // script.async = true;
  script.src = '/__/firebase/init.js';
  script.onload = onload;
  document.head.appendChild(script);

  // Enable firestore persistence
  setTimeout(() => {
    const firestore = firebase.firestore();
    firestore.settings({
      timestampsInSnapshots: true,
    });
    firestore.firestore().enablePersistence()
      .catch(function(err) {
        if (err.code === 'failed-precondition') {
          throw new Error('Multiple tabs open, persistence can only be enabled in one tab at a a time.');
        } else if (err.code === 'unimplemented') {
          throw new Error('The current browser does not support all of the features required to enable persistence');
        }
      });
  }, 200);
</script>
